let total_characters=0, time=60, counter_start;let lblWord=0, lblChars=0, lblWpm=0, lblAccuracy=(100).toFixed(2), lblErrors=0;let texts=[], givenTexts=[], items=[];let txtarea=document.querySelector("#txtarea"), startBtn=document.querySelector("#start");let words=document.querySelector("#words"), characters=document.querySelector("#characters");let wordsperminute=document.querySelector("#wpm"), lblTime=document.querySelector("#time");let complete=document.querySelector("#testComplete"), follow=document.querySelector("#follow");let cError=document.querySelector("#cErrors"), accuracy=document.querySelector("#accuracy");let text=`Once, there was an old man who had four sons. All four of them were very lazy. One day, the old man fell sick and was counting his last days in bed. He worried a lot about his sons' future as the young men hesitated a lot to work. The sons believed that luck would favour them. The old man's health deteriorated every day and he decided to talk to his sons about their future. However, his sons did not listen to him. Finally, the old man decided to play a trick to let his sons realize the importance of work. He called all his sons and let them sit near him on his bed. He said that he had a treasure box with gold coins and expensive gems for them and wanted to share the treasure equally among the four of them.`;(function (){extractGiven(); for(let i=0; i < givenTexts.length; i++){let span=document.createElement("span"); span.setAttribute("class","p-1"); span.append(givenTexts[i] + " "); items.push(span); follow.append(items[i]);}})();function updateWord(){let x=txtarea.value, newline_count=0; for(let i=0; i < x.length; total_characters++, i++); getErrors(); visualAspectOn(); words.innerText=`${lblWord=texts.length}`; characters.innerText=`${lblChars=total_characters + 1}`; wordsperminute.innerText=`${lblWpm=texts.length - lblErrors}`; cError.innerText=`${lblErrors}`; accuracy.innerText=`${lblAccuracy=(((lblWord - lblErrors) / lblWord) * 100).toFixed(2)}`; total_characters=0; lblErrors=0; texts.splice(0,texts.length); givenTexts.splice(0,givenTexts.length);}function visualAspectOn(){if(texts[texts.length]==givenTexts[givenTexts.length]) items[texts.length - 1].setAttribute("class","bg-dark text-light rounded-custom p-1"); for(let i=0; i < texts.length - 1; i++){if(texts[i]==givenTexts[i]) items[i].setAttribute("class","text-success p-1"); else items[i].setAttribute("class","text-danger p-1");}for(let j=items.length; j >=texts.length; j--){if(items[j] !=texts[j]) items[j].setAttribute("class","p-1");}}function visualAspectOff(){for(let i=0; i < items.length; items[i].setAttribute("class","p-1"), i++);}function getErrors(){extractTextArea(); extractGiven(); for(let i=0; i < texts.length; i++){if(texts[i] !=givenTexts[i]) lblErrors++;}}function extractTextArea(){let lines=$(txtarea).val().split(/\s/); for(let i=0; i < lines.length; i++){if(/\S/.test(lines[i])) texts.push((lines[i]).trim());}}function extractGiven(){let givenText=text.split(/\s/); for(let i=0; i < givenText.length; i++){if(/\S/.test(givenText[i])) givenTexts.push((givenText[i]).trim());}}function timer(){if(time==-1){time=60; clearInterval(counter_start); txtarea.disabled=true; updateWord(); complete.innerText=`Test Complete!`; lblTime.setAttribute("class","fw-bold h6 dark-mode-color-1");}if(time < 6) lblTime.setAttribute("class","fw-bold h6 text-danger"); lblTime.innerText=`${time--}s`;}function start(){counter_start=setInterval(timer,1000); startBtn.disabled=true; txtarea.disabled=false; txtarea.focus(); txtarea.select();}function reset(){visualAspectOff(); txtarea.value=""; startBtn.disabled=false; txtarea.disabled=true; words.innerText=`${texts.length}`; characters.innerText=`${total_characters=0}`; wordsperminute.innerText=`${lblWpm=0}`; lblTime.innerText=`${time=60}s`; accuracy.innerText=`${lblAccuracy=(100).toFixed(2)}`; cError.innerText=`${lblErrors=0}`; lblTime.setAttribute("class","fw-bold h6 dark-mode-color-1"); complete.innerText=``; clearInterval(counter_start);}txtarea.addEventListener('keypress', (e)=>{if(e.key=="Enter") event.preventDefault(); updateWord();});
